
$(document).ready(() => {

  $('.title').html(t('advice.title', { number: 0 }));
  
  $('#advice').click(async (e) => {
    const url = 'https://api.adviceslip.com/advice';
    const data = await $.getJSON(url);
    const { id, advice } = data.slip;
    let a;
    
    if (Cookies.get('language') != 'en') {
       const a = await translate(advice, Cookies.get('language'));
      $('.title').html(t('advice.title', { number: id }));
      $('.advice').html(t('advice.description', { data: a }));
      return;
    };
    
    $('.title').html(t('advice.title', { number: id }));
    $('.advice').html(t('advice.description', { data: advice }));

  });

});

if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('src/services/work.js')
    .then(registration => {
      console.log('[ Advice ] - Currently working')
      return registration.update();
    }).then(registration => {
      console.log('[ Advice ] - ServiceWorker is running')
    }).catch(err => {
      console.log(`[ Advice ] - Not working: ${err.message}`);
    });
  });
};